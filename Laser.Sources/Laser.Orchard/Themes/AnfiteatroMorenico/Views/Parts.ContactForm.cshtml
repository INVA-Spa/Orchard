@using Orchard.Utility.Extensions
@using Laser.Orchard.ContactForm.ViewModels
@{
    Script.Require("jQuery").AtHead();
    Script.Require("jQueryColorBox").AtHead();
    Style.Require("jQueryColorBox").AtHead();
    Style.Include("ContactForm.css").AtHead();
    const string displayNone = "style=\"display:none\"";
    var contactForm = (ContactFormViewModel)Model.ContactForm;
    var displaySubject = contactForm.ShowSubjectField ? string.Empty : displayNone;
    var displayName = contactForm.ShowNameField ? string.Empty : displayNone;
    var displayAttachmentButton = contactForm.EnableFileUpload ? string.Empty : displayNone;
    var uniqueId = Model.ContentPart.Id;
}
@{using (Html.BeginForm("sendcontactemail", "contactform", new { area = "Laser.Orchard.ContactForm" }, FormMethod.Post, new { @class = "contact-form" })) {
    <div class="row">
        <div class="col-sm-12">
            <div class="form-group">
                <label class="control-label">@T("Name") <span class="required">*</span></label><br />
                <input type="text" placeholder="@T("Name")" class="form-control" size="40" value="" name="Name">
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-6">
            <div class="form-group">
                <label class="control-label">@T("E-mail") <span class="required">*</span></label><br />
                <input type="email" placeholder="@T("E-mail")" class="form-control" size="40" value="" name="Email">
            </div>
        </div>
        <div class="col-sm-6">
            <div class="form-group">
                <label class="control-label">@T("Confirm E-mail") <span class="required">*</span></label><br />
                <input type="email" placeholder="@T("Confirm E-mail")" class="form-control" size="40" value="" name="ConfirmEmail">
            </div>
        </div>
    </div>

    <div class="row">

        <div class="col-sm-6">
            <div class="form-group">
                <label>@T("Phone")</label><br />
                <input type="tel" placeholder="@T("Phone")" class="form-control" maxlength="10" size="40" value="" name="Phone">
            </div>
        </div>
    </div>

    <div class="form-group">
        <label class="control-label">@T("Message") <span class="required">*</span></label><br />
        <textarea placeholder="@T("Message")" class="form-control" rows="4" cols="40" name="Message"></textarea>
    </div>

    <div class="form-group" id="AttachmentSection-@uniqueId" type="hidden">
        <img id="AttachmentPreview-@uniqueId" ></img>
        <label id="AttachmentNameLabel-@uniqueId"></label>
        <br />
    </div>
    <input id="ReturnUrl-@uniqueId" name="ReturnUrl" type="hidden" value="@Context.Request.ToUrlString()" />
    <input id="Id-@uniqueId" name="Id" type="hidden" value="@uniqueId" />
    <input id="MediaId-@uniqueId" name="MediaId" type="hidden" value="" />
    @Html.AntiForgeryTokenOrchard()
    <input id="attachment_button-@uniqueId" type="button" @Html.Raw(displayAttachmentButton) value="@T("Add attachment")" />

    <div class="clear"></div>

    <input type="submit" class="btn btn-danger" value="@T("Send")">
  }
}

@using (Script.Head()) {
    <script type="text/javascript">
        $(document).ready(function () {
            $('#attachment_button-@uniqueId').click(function () {
                $.colorbox({ iframe: true, width: "40%", height: "26%", href: "@(Url.Action("Add", "FileUpload", new { Area = "Laser.Orchard.ContactForm" }) + "?ContactFormID=" + uniqueId)", title: "@T("Upload file")" });
            });

            $('#MediaId-@uniqueId').change(function () {
                if ($('#MediaId-@uniqueId').val() != '') {
                     $('#attachment_button-@uniqueId').attr('disabled', 'disabled');
                 }
             });
        });
    </script>
}