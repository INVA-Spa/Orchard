jQuery(function(n){var u=function(){try{return"localStorage"in window&&window.localStorage!==null}catch(n){return!1}},p=function(n){s=!!n.Response},s=!0,r=function(n){return u()&&(localStorage["nwazet-cart-loading"]=!!n),h=!!n},h=u()?localStorage["nwazet-cart-loading"]=="true":!1,i="nwazet.cart",t=n("#shopping-cart-main-container"),c=function(n){return function(t){return b(t.closest("form"))===1&&u()&&localStorage.removeItem(i),t.closest(n).find("input.quantity").val(0).closest("form")}},e=function(i){return!h&&i&&i.length>0&&(r(!0),t.load(i[0].action||k,i.serializeArray(),f),n(this).trigger("nwazet.cartupdating")),!1},w=function(t,i){return n.each(t,function(t,r){t!=="__RequestVerificationToken"&&i.append(n("<input type='hidden'/>").attr("name",t).val(r))}),i},l=function(t){n("#shopping-cart-notification").html(t).show();console.log(t)},f=function(f,c){var p,a,k,y,d,b,v;if(n("#shopping-cart-notification").hide(),c==="error")l(window.Nwazet.FailedToLoadCart);else{if(p=f===!1||typeof f=="string"&&n.trim(f).length>0,u())if(s){if(p)a=t.find("form"),a.length===0&&(a=t.closest("form")),a.length!==0&&a[0].length>1&&(k=a.serializeArray(),y={},n.each(k,function(n,t){y[t.name]=t.value}),delete y.__RequestVerificationToken,localStorage[i]=JSON.stringify(y)),r(!1);else if(b=localStorage[i],b){if(h){localStorage[i]=JSON.stringify({Country:localStorage[i].Country||null,ZipCode:localStorage[i].ZipCode||null});r(!1);return}try{d=JSON.parse(b)}catch(g){localStorage.removeItem(i);return}if(v=t.closest("form"),v.length===0&&(v=n("<form><\/form>").append(n("<input name='__RequestVerificationToken'/>").val(o))),w(d,v),l(window.Nwazet.WaitWhileWeRestoreYourCart),t.hasClass("minicart"))e(v);else{r(!0);t.closest("form").submit();return}}}else r(!1),localStorage.removeItem("nwazet.cart"),localStorage.removeItem("nwazet-cart-loading");t.hasClass("minicart")?t.parent().toggle(p):r(!1);n(this).trigger("nwazet.cartupdated")}},b=function(t){var i=-1,r;return t&&(r=t.serializeArray(),n.each(r,function(){var n=this.name;n.substr(0,6)==="items["&&n.slice(-11)==="].ProductId"&&(i=Math.max(i,+n.slice(6,n.length-11)))}),i++),i},a=t.data("load"),k=t.data("update"),o=t.data("token"),v=t.data("use-local-storage"),y;v&&(o||(o=t.closest("form").find("[name=__RequestVerificationToken]")[0].value),y={__RequestVerificationToken:o},n.ajax({url:v,data:y,type:"POST",async:!1,success:p}));a?t.load(a,f).parent().hide():f(t.data("got-cart")===!1);n(document).on("click",".shoppingcart .delete",function(){n(this).trigger("nwazet.removefromcart");c("tr,li")(n(this)).submit()}).on("click",".minicart .delete",function(){return n(this).trigger("nwazet.removefromcart"),e(c("tr,li")(n(this)))}).on("click",".shoppingcart .update-button",function(){return s&&u()&&localStorage.removeItem(i),e(n(this).closest("form"))}).on("click",".minicart .update-button",function(){return e(n(this).closest("form"))}).on("submit","form.addtocart",function(i){n(this).trigger("nwazet.addtocart");i.preventDefault();var u=n(this),r=u.serializeArray(),e=this.action,o=n("input[type=file]:enabled",u);o.length>0?(r.push({name:"isAjaxRequest",value:!0}),n.ajax(e,{type:"POST",data:r,files:o,iframe:!0}).done(function(n){t.html(n);f(n,"success")})):t.load(e,r,f);n(this).trigger("nwazet.addedtocart")})});